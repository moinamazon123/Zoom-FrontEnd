<!-- recorded class list view -->

<div style="background-color: #206c5c;color:white; padding: 5px; margin-bottom: 20px;">
    <div fxLayout="row" fxLayoutAlign="center center">
      <h2>Recorded Classes</h2>
    </div>
  </div>


  
<!-- filters for admin -->


<mat-accordion *ngIf="role == 'admin'">
    <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false" >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>filter_list</mat-icon>
          <h3>Filters</h3>
        </mat-panel-title>
        <mat-panel-description>
  
        </mat-panel-description>
      </mat-expansion-panel-header>
  
      <!-- filters for admin -->
      <div fxLayout="row"  fxLayoutAlign="center center" fxFlex="100">
        <!-- grade -->
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <div fxLayoutAlign="center center">
          </div>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by Grade</mat-label>
            <mat-select [(ngModel)]="slectedgrade" (selectionChange)="
            gradeChange({
              pageNo: 0,
              maxResult: 20
            });
            this.page = 1
          ">
              <mat-option value="all">All</mat-option>
              <mat-option *ngFor="let item of gradelist" [value]="item.gradeId">Grade {{ item.gradeName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <!-- gradeends -->
        <!-- Program  -->
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by Program</mat-label>
            <mat-select [(ngModel)]="slectedsylabus" (selectionChange)="
          syllabusChange({
            pageNo: 0,
            maxResult: 20
          });
          this.page = 1
          ">
              <mat-option value="all">All</mat-option>
              <mat-option *ngFor="let item of syllabuslist" [value]="item.syllabusId">{{ item.syllabusName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <!-- Program end -->
  
        <!-- subject -->
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by Subject</mat-label>
            <mat-select [(ngModel)]="slectedsubject" (selectionChange)="
            subjectChange({
              pageNo: 0,
              maxResult: 20
            });
            this.page = 1
          ">
              <mat-option value="all">All</mat-option>
              <mat-option *ngFor="let item of subjectlist" [value]="item.subjectId">
                {{ item.subjectName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <!-- subject ends -->
  
        <!-- chapter -->
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by Chapter</mat-label>
            <mat-select name="slectedchapter" [(ngModel)]="slectedchapter" (selectionChange)="
            chapterChange({
              pageNo: 0,
              maxResult: 20
            });
            this.page = 1
            ">
              <mat-option value="all">All</mat-option>
              <mat-option *ngFor="let item of chapterlist" [value]="item.chapterId">
                {{ item.chapterName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <!-- chapter ends -->
  
        <!-- Teacher -->
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by Teacher</mat-label>
            <mat-select [(ngModel)]="slectedteacher" (selectionChange)="
            teacherChange({
              pageNo: 0,
              maxResult: 20
            });
            this.page = 1
          ">
              <mat-option value="all">All</mat-option>
              <mat-option *ngFor="let item of teacherlist" [value]="item.firstName">{{ item.firstName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
  
      <div fxLayout="row" *ngIf="role == 'admin'" fxLayoutAlign="start center" fxFlex="100">
        <div fxLayout="row" fxLayoutAlign="end end" fxFlex="24">
          <mat-form-field>
            <input matInput #input [matDatepicker]="start" [max]="mindate" disabled placeholder="Start Date" name="startDateadmin"
              [(ngModel)]="startDateadmin" (dateChange)="finalstartendDate( {
                pageNo: 0,
                maxResult: 20
              });
              this.page = 1" />
            <mat-datepicker-toggle matSuffix [for]="start"></mat-datepicker-toggle>
            <mat-datepicker #start disabled="false"></mat-datepicker>
          </mat-form-field>
        </div>
        <div fxLayout="row" fxLayoutAlign="center end" fxFlex="20">
          <mat-form-field>
            <input matInput [matDatepicker]="end" [min]="startDateadmin" [max]="mindate" placeholder="end Date"
             disabled name="endDateadmin" [(ngModel)]="endDateadmin"
              (dateChange)="finalstartendDate( {
                pageNo: 0,
                maxResult: 20
              });
              this.page = 1" />
            <mat-datepicker-toggle matSuffix [for]="end"></mat-datepicker-toggle>
            <mat-datepicker #end [disabled]="startDateadmin == 'all'"></mat-datepicker>
          </mat-form-field>
        </div>
  
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
            <mat-form-field style="font-size: 17px;">
              <mat-label>Type of Class</mat-label>
              <mat-select [(ngModel)]="slectedtype" (selectionChange)="
              typeChange({
                pageNo: 0,
              maxResult: 20
            });
            this.page = 1
            ">
            <mat-option value="all">All</mat-option>
                <mat-option value="others (Admin & teacher)">others (Admin & teacher)</mat-option>
                <mat-option value="Members">Member</mat-option>
                <mat-option value="Guest">Guest</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
  
        <!-- reset -->
        <div fxLayout="row" fxLayoutAlign="start start" fxFlex="10">
          <button mat-raised-button color="accent" (click)="resetFilter({
            pageNo: 0,
            maxResult: 20
          });
          this.page = 1">Reset</button>
        </div>
        <!-- reset -->
      </div>
  
    </mat-expansion-panel>
  </mat-accordion>

  <!-- admin filter ends -->

  
<!-- <div fxLayout="row" *ngIf="role == 'admin' || role == 'teacher'">
    <div fxLayoutAlign="center center">
        <mat-icon>filter_list</mat-icon>
      </div>
      <mat-form-field style="font-size: 17px;">
        <mat-label>Filter by Grade</mat-label>
        <mat-select
          [(ngModel)]="slectedgrade"
          (selectionChange)="
            gradeChange({
              pageNo: 0,
              maxResult: 20
            });
            this.page = 1
          "
        >
          <mat-option value="all">All</mat-option>
          <mat-option *ngFor="let item of gradelist" [disabled]="item.disabled" [value]="item.gradeId">Grade {{ item.gradeName }}</mat-option>
        </mat-select>
      </mat-form-field>
  </div> -->
  
  <div fxLayout="row" *ngIf="role == 'student'">
  
    <form>
      <div fxLayout="row" *ngIf="role == 'student'" fxLayoutAlign="start center" fxFlex="100">
        <!-- teacher -->
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by program</mat-label>
            <mat-select name="slectedsylabus" [(ngModel)]="slectedsylabus" (selectionChange)="
            getsubjectsforgradestudent({
              pageNo: 1,
              maxResult: 9
            });
            this.page = 1
          ">
              <!-- <mat-option value="all">All</mat-option> -->
              <mat-option *ngFor="let item of syllabuslist" [value]="item.syllabusId">{{ item.syllabusName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field style="font-size: 17px;">
            <mat-label>Filter by subject</mat-label>
            <mat-select name="slectedsubject" [(ngModel)]="slectedsubject" (selectionChange)="
                  subjectChange({
                      pageNo: 1,
                      maxResult: 9
                    });
                    this.page = 1
                  ">
              <mat-option value="all">All</mat-option>
              <mat-option *ngFor="let item of subjectlist" [value]="item.subjectId">{{ item.subjectName }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
    
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1' >
          <mat-form-field>
            <input matInput #input [matDatepicker]="start" [max]="mindate" placeholder="Particular Date" disabled
              name="startDate" [(ngModel)]="startDate" (dateChange)="finalstartendDate( {pageNo: 1,
                maxResult: 9
              });
              this.page = 1" />
            <mat-datepicker-toggle matSuffix [for]="start"></mat-datepicker-toggle>
            <mat-datepicker #start disabled="false"></mat-datepicker>
          </mat-form-field>
        </div>
    
    
        <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset='1'>
          <mat-form-field >
            <input matInput #input [matDatepicker]="end" [max]="mindate" disabled placeholder="To Date"
              name="endDate" [(ngModel)]="endDate" (dateChange)="finalstartendDate( {pageNo: 1,
            maxResult: 9
          });
          this.page = 1" />
            <mat-datepicker-toggle matSuffix [for]="end"></mat-datepicker-toggle>
            <mat-datepicker #end disabled="false"></mat-datepicker>
          </mat-form-field>
        </div>
        <!-- reset -->
        <div fxLayout="row" fxLayoutAlign="start start" fxFlexOffset='1'>
          <button mat-raised-button color="accent" type="reset" (click)="resetFilter({
          pageNo: 1,
          maxResult: 9
        });
        this.page = 1">Reset</button>
        </div>
        <!-- reset -->
      </div>
    </form>
  </div>

<div fxLayout="row" fxLayoutAlign="space-between center" class="flex-p">
  <div fxLayout="row">
    <mat-button-toggle-group #controls="matButtonToggleGroup">
      <mat-button-toggle value="Search"> <mat-icon matTooltip="Search">search</mat-icon> </mat-button-toggle>
      <mat-button-toggle *ngIf="role == 'admin'" value="Delete" [disabled]="!deleteMultipleArr.length>0" (click)="ondeleteRecord({
          pageNo: 0,
          maxResult: 20
        });
        this.page = 1"> <mat-icon matTooltip="Delete" [ngClass] ="{'delete_btn':deleteMultipleArr.length>0}" >delete_forever</mat-icon> </mat-button-toggle>
    </mat-button-toggle-group>
  </div>
  <form class="user-search" [class.show]="controls.value == 'Search'" autocomplete="off">
    <mat-form-field class="user-search-input"
      ><input matInput (keyup)="applyFilter($event.target.value)" placeholder="Search Recorded Class...(based on any field)" [(ngModel)]="searchText" name="search"
    /></mat-form-field>
  </form>
  <div fxLayout="row" fxLayoutAlign="space-between center">
    <mat-button-toggle-group #viewType="matButtonToggleGroup">
        <button mat-raised-button color="primary" (click)="gridRouting()"><mat-icon>view_module</mat-icon>Grid View</button>
      <button mat-raised-button color="accent"><mat-icon>view_list</mat-icon>List View</button>
    </mat-button-toggle-group>
  </div>
</div>





<div>
  <table fxFill="100" mat-table [dataSource]="dataSourcetable" matSort (matSortChange)="sortData($event)" matSortDisableClear>

      <ng-container matColumnDef="Select">
          <th mat-header-cell *matHeaderCellDef>
            <mat-checkbox *ngIf="role == 'admin'" (change)="$event ? masterToggle($event) : null"
                          [checked]="selection.hasValue() && isAllSelected()"
                          [indeterminate]="selection.hasValue() && !isAllSelected()"
                          [aria-label]="checkboxLabel()" class="checkBoxBtn">
                          &nbsp;  &nbsp;  &nbsp; </mat-checkbox> 
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox *ngIf="role == 'admin'"
                          (change)="$event ? selection.toggle(row) : null"
                          [checked]="selection.isSelected(row)"
                          [aria-label]="checkboxLabel(row)"
                          (change)="onClickCheckBox($event,row)">
                          &nbsp; &nbsp; &nbsp; </mat-checkbox>
          </td>
          <!-- <th mat-header-cell *matHeaderCellDef mat-sort-header matSortDirection="asc">Select</th>
          <td class="text-center" mat-cell *matCellDef="let row">sdsds</td> -->
        </ng-container>

    <ng-container matColumnDef="No.">
      <th mat-header-cell *matHeaderCellDef>No.</th>
      <td mat-cell *matCellDef="let row; let i = index">{{ pageSize * pageNo + (i + 1) }} )</td>
    </ng-container>

    <ng-container matColumnDef="Title">
      <th mat-header-cell *matHeaderCellDef style="text-align: center;">Title</th>
      <td class="text-center" mat-cell *matCellDef="let row">{{ row.title }}</td>
    </ng-container>

    <ng-container matColumnDef="gradeName">
        <th class="text-center" mat-header-cell *matHeaderCellDef>Grade</th>
        <td class="text-center" mat-cell *matCellDef="let row">{{ row.gradeName }}</td>
      </ng-container>

    <ng-container matColumnDef="subjectName">
      <th class="text-center" mat-header-cell *matHeaderCellDef>Subject Name</th>
      <td class="text-center" mat-cell *matCellDef="let row">{{ row.subjectName }}</td>
    </ng-container>

    <ng-container matColumnDef="Teacher Name">
      <th class="text-center" mat-header-cell *matHeaderCellDef>Teacher Name&nbsp;  &nbsp;  &nbsp; &nbsp;</th>
      <td class="text-center" mat-cell *matCellDef="let row">{{ row.presenterDisplayName }}</td>
    </ng-container>

    <ng-container matColumnDef="class held date">
      <th class="center" mat-header-cell *matHeaderCellDef mat-sort-header matSortDirection="asc">Date of Class held</th>
      <td class="text-center" mat-cell *matCellDef="let row">{{ row.scheduledDate | date : 'dd/MM/yyyy' }}</td>
    </ng-container>

    <ng-container matColumnDef="view Recording">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let row">
        <div fxLayout="row" fxLayout.lt-sm="column" fxLayoutAlign.gt-sm="space-between center">
         
            <button class="button" [disabled]="role == 'guest'" (click)="getintorecordedclass(row)" mat-raised-button color="primary"><span *ngIf="role != 'guest'">Recorded Class</span><span *ngIf="role == 'guest'">Only For Members</span></button>
          
          <div *ngIf="role == 'admin'" fxFlex="30" fxLayoutAlign="center center">
            <button class="button" (click)="getAttendees(row)" mat-button color="primary">
              <mat-icon>group</mat-icon>
              Attendees
            </button>
          </div>
          <div  *ngIf="role == 'admin'" fxFlex="30">
            <button class="button" (click)="getViewers(row)" mat-button color="primary">
              <mat-icon>video_library</mat-icon>
              Viewers
            </button>
          </div>
          <div>
            <button mat-icon-button [matMenuTriggerFor]="menu" #menuTrigger="matMenuTrigger"><mat-icon>more_vert</mat-icon></button>
          </div>

          <mat-menu #menu="matMenu" xPosition="before">
            <button *ngIf="role == 'admin'" mat-menu-item (click)="deleteclass(row.sessionId)">
              <mat-icon>delete</mat-icon>
              <span>Delete</span>
            </button>

            <button *ngIf="role == 'admin'" mat-menu-item (click)="openrecordedStat(row)">
              <mat-icon>pie_chart</mat-icon>
              <span>Recorded Analytics</span>
            </button>
            <button mat-menu-item (click)="openmoreinfo(row)">
              <mat-icon>more</mat-icon>
              <span>More Info</span>
            </button>
          </mat-menu>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumnsForrecorder"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumnsForrecorder"></tr>
  </table>

  <!-- if no recorded class found -->

  <div *ngIf="dataSourcetable?.data.length == 0 " fxLayout="row" fxFill="60" fxLayoutAlign="center center">
    <div ><h1 style="margin-top: 26px !important; margin-bottom:10px; opacity:0.5;">No  Recorded Class Found!!!</h1></div>
  </div>

  <div *ngIf="!dataSourcetable"><div class="skeleton"></div></div>
  <!-- <mat-paginator [hidePageSize]="false" (page)="pageEvent = $event; pageno($event)" [length]="lengthForPagination" [pageSizeOptions]="[5, 10, 15, 20]"></mat-paginator> -->
  <mat-paginator [hidePageSize]="false" [pageSize]="pageSize" [pageIndex]="pageNo" (page)="pageEvent = $event; pageno($event)" [length]="lengthForPagination" [pageSizeOptions]="[30, 50, 100, 150]"></mat-paginator>

</div>
